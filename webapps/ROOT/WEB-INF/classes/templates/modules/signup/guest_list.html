<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="${request.contextPath}/statics/css/icon.css">
<link rel="stylesheet" href="${request.contextPath}/statics/css/element.css">
<title>客户列表</title>
</head>
<body>
    <#include "/header.html">
    <div class="cvpage_title_common">客户列表</div>
    <div id="guest_list" class="cv_page_content">

        <!-------主页面-------列表开始------->
        <div v-show="!showChildPage"> 
            <!--列表搜索区-->
            <div class="cv_content_square">
                <el-form :model="searchForm" status-icon class="demo-ruleForm" label-width="35%" label-position="right" @submit.native.prevent>
                    <el-row class="el-row-h60">
                        <el-col :span="7">
                            <el-form-item label="客户姓名" style="margin:0;">
                                <el-input
                                clearable
                                type="text"
                                v-model="searchForm.customerName"
                                auto-complete="off"></el-input>
                            </el-form-item>
                        </el-col>
                        <el-col :span="6">
                            <el-form-item label="客户手机" style="margin:0;">
                                <el-input
                                clearable
                                type="text"
                                v-model="searchForm.customerPhone"
                                auto-complete="off"></el-input>
                            </el-form-item>
                        </el-col>
                        <el-col :span="7">
                            <el-form-item label="销售姓名" style="margin:0;">
                                <el-input
                                clearable
                                type="text"
                                v-model="searchForm.customerSale"
                                auto-complete="off"></el-input>
                            </el-form-item>
                        </el-col>
                        <el-col :span="3" :offset="1" class="el-row-h40">
                            <el-button type="primary" style="width:100%" icon="el-icon-search" @click="startSearch(0)">搜索</el-button>
                        </el-col>
                    </el-row>
                </el-form>
            </div>
            <!--功能按钮区-->
            <el-row class="el-row-h50">
                <el-col :span="3">
                    <el-button type="primary" plain style="width:100%" icon="el-icon-download" @click="downloadData">导出数据</el-button>
                </el-col>
            </el-row>
            <!--表格查询结果区-->
            <div class="cv_content_square">
                <el-table :data="guestTableData" style="width: 100%; margin:10px auto 30px;" stripe>
                    <el-table-column prop="customerName" label="姓名" width="90"></el-table-column>
                    <el-table-column prop="customerCompany" label="公司" width="110">
                        <template slot-scope="scope">
                            <div class="twolineobv" v-text="scope.row.customerCompany"></div>
                        </template>
                    </el-table-column>
                    <el-table-column prop="customerPosition" label="职位" width="100"></el-table-column>
                    <el-table-column prop="customerCity" label="城市" width="90"></el-table-column>
                    <el-table-column prop="customerPhone" label="手机号" width="120"></el-table-column>
                    <el-table-column prop="customerSale" label="所属销售" width="90"></el-table-column>
                    <el-table-column prop="customerStatus" label="跟踪状态" width="">
                        <template slot-scope="scope">
                            <div class="twolineobv" v-text="scope.row.customerStatus"></div>
                        </template>
                    </el-table-column>
                    <el-table-column prop="customerCrtTime" label="创建时间" width="160"></el-table-column>
                    <el-table-column prop="customerModTime" label="更新时间" width="160"></el-table-column>
                    <el-table-column label="操作" width="90" fixed="right">
                        <template slot-scope="scope">
                            <el-button type="text" size="small" @click="editThisGuest(scope.row)">编辑</el-button>
                            <el-button type="text" size="small" @click="delThisGuest(scope.row)">删除</el-button>
                        </template>
                    </el-table-column>
                </el-table>
            </div>
            <!--分页器-->
            <div class="cv_page_zone">
                <el-pagination
                    @current-change="handleCurrentChange"
                    :current-page="pagination1.currPage"
                    :page-size="pagination1.pageSize"
                    layout="total, prev, pager, next, jumper"
                    :total="pagination1.totalCount">
                </el-pagination>
            </div>
            
        </div>
        <!-------主页面-------专栏列表结束------->
        
        <!-------子页面-------新建编辑开始------->
        <div v-show="showChildPage">
            <div class="cv_content_square">
                <el-form :model="guestForm" :rules="guestFormRules"  ref="guestForm" status-icon class="demo-ruleForm" label-width="20%" label-position="right">
                    <el-row class="el-row-h70">
                        <el-col :span="12">
                            <el-form-item label="客户姓名" prop="customerName" style="margin:0;">
                                <el-input
                                clearable
                                type="text"
                                v-model="guestForm.customerName"
                                auto-complete="off"
                                :disabled="true"></el-input>
                            </el-form-item>
                        </el-col>
                        <el-col :span="12">
                            <el-form-item label="公司" prop="customerCompany" style="margin:0;">
                                <el-input
                                clearable
                                type="text"
                                v-model="guestForm.customerCompany"
                                auto-complete="off"
                                :disabled="true"></el-input>
                            </el-form-item>
                        </el-col>
                    </el-row>
                    <el-row class="el-row-h70">
                        <el-col :span="12">
                            <el-form-item label="职位" prop="customerPosition" style="margin:0;">
                                <el-input
                                clearable
                                type="text"
                                v-model="guestForm.customerPosition"
                                auto-complete="off"
                                :disabled="true"></el-input>
                            </el-form-item>
                        </el-col>
                        <el-col :span="12">
                            <el-form-item label="城市" prop="customerCity" style="margin:0;">
                                <el-input
                                clearable
                                type="text"
                                v-model="guestForm.customerCity"
                                auto-complete="off"
                                :disabled="true"></el-input>
                            </el-form-item>
                        </el-col>
                    </el-row>
                    <el-row class="el-row-h70">
                        <el-col :span="12">
                            <el-form-item label="手机号" prop="customerPhone" style="margin:0;">
                                <el-input
                                clearable
                                type="text"
                                v-model="guestForm.customerPhone"
                                auto-complete="off"
                                :disabled="true"></el-input>
                            </el-form-item>
                        </el-col>
                        <el-col :span="12">
                            <el-form-item label="所属销售" prop="customerSale" style="margin:0;">
                                <el-input
                                clearable
                                type="text"
                                v-model="guestForm.customerSale"
                                auto-complete="off"
                                maxlength="30"></el-input>
                            </el-form-item>
                        </el-col>
                    </el-row>
                    <el-row class="el-row-h120">
                        <el-col :span="24">
                            <el-form-item prop="customerStatus" label-width="10%" label="跟踪状态" style="margin:0;">
                                <el-input
                                maxlength="200"
                                clearable
                                type="textarea"
                                :autosize="{ minRows: 4, maxRows: 4}"
                                placeholder="最多200个字"
                                v-model="guestForm.customerStatus"
                                auto-complete="off">
                                </el-input>
                            </el-form-item>
                        </el-col>
                    </el-row>
                    <el-row class="el-row-h60" style="margin-top:10px;">
                        <el-col :span="4" :offset="7">
                            <el-button type="primary" style="width:100%" @click="submitEditGuest('guestForm')">确认</el-button>
                        </el-col>
                        <el-col :span="4" :offset="2">
                            <el-button type="primary" style="width:100%" @click="backToList('guestForm')">取消</el-button>
                        </el-col>
                    </el-row>
                </el-form>
            </div>
        </div>
        <!-------子页面-------新建编辑结束------->

    </div>
</body>
<script type="text/javascript" src="${request.contextPath}/statics/libs/jquery.min.js"></script>
<script type="text/javascript" src="${request.contextPath}/statics/libs/jquery.base64.js"></script>
<script type="text/javascript" src="${request.contextPath}/statics/js/element.js"></script>
<script type="text/javascript" src="${request.contextPath}/statics/js/modules/signup/guest_list.js"></script>
<script type="text/javascript" src="${request.contextPath}/statics/js/clockToast.js"></script>

<style>
.twolineobv{
    text-overflow: -o-ellipsis-lastline;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    line-clamp: 2;
    -webkit-box-orient: vertical;
}
</style>

</html>